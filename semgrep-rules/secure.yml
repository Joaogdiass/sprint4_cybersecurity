rules:
  - id: no-sql-string-concat
    message: "Use query parametrizada; não concatene strings em SQL."
    severity: ERROR
    languages: [python]
    pattern-either:
      - pattern: cursor.execute($SQL + $X)
      - pattern: cursor.execute(f"...")
      - pattern: cursor.execute("SELECT " + $X)

  - id: no-debug-in-prod
    message: "DEBUG habilitado em produção."
    severity: ERROR
    languages: [python]
    pattern: DEBUG = True

  - id: jwt-must-have-exp
    message: "JWT deve conter 'exp' e validação de expiração."
    severity: WARNING
    languages: [python, js, ts]
    pattern-either:
      - pattern: jwt.encode($PAYLOAD, $KEY, ...)
      - pattern: jwt.sign($PAYLOAD, $KEY, ...)
